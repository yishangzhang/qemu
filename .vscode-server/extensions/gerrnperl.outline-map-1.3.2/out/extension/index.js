(()=>{var t={5623:t=>{"use strict";function e(t,e,s){t instanceof RegExp&&(t=n(t,s)),e instanceof RegExp&&(e=n(e,s));var o=i(t,e,s);return o&&{start:o[0],end:o[1],pre:s.slice(0,o[0]),body:s.slice(o[0]+t.length,o[1]),post:s.slice(o[1]+e.length)}}function n(t,e){var n=e.match(t);return n?n[0]:null}function i(t,e,n){var i,s,o,r,a,c=n.indexOf(t),l=n.indexOf(e,c+1),h=c;if(c>=0&&l>0){if(t===e)return[c,l];for(i=[],o=n.length;h>=0&&!a;)h==c?(i.push(h),c=n.indexOf(t,h+1)):1==i.length?a=[i.pop(),l]:((s=i.pop())<o&&(o=s,r=l),l=n.indexOf(e,h+1)),h=c<l&&c>=0?c:l;i.length&&(a=[o,r])}return a}t.exports=e,e.range=i},3644:(t,e,n)=>{var i=n(5623);t.exports=function(t){return t?("{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2)),f(function(t){return t.split("\\\\").join(s).split("\\{").join(o).split("\\}").join(r).split("\\,").join(a).split("\\.").join(c)}(t),!0).map(h)):[]};var s="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",r="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function l(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function h(t){return t.split(s).join("\\").split(o).join("{").split(r).join("}").split(a).join(",").split(c).join(".")}function p(t){if(!t)return[""];var e=[],n=i("{","}",t);if(!n)return t.split(",");var s=n.pre,o=n.body,r=n.post,a=s.split(",");a[a.length-1]+="{"+o+"}";var c=p(r);return r.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}function u(t){return"{"+t+"}"}function d(t){return/^-?0\d/.test(t)}function g(t,e){return t<=e}function m(t,e){return t>=e}function f(t,e){var n=[],s=i("{","}",t);if(!s)return[t];var o=s.pre,a=s.post.length?f(s.post,!1):[""];if(/\$$/.test(s.pre))for(var c=0;c<a.length;c++){var h=o+"{"+s.body+"}"+a[c];n.push(h)}else{var y,w,b=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),S=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),v=b||S,T=s.body.indexOf(",")>=0;if(!v&&!T)return s.post.match(/,.*\}/)?f(t=s.pre+"{"+s.body+r+s.post):[t];if(v)y=s.body.split(/\.\./);else if(1===(y=p(s.body)).length&&1===(y=f(y[0],!1).map(u)).length)return a.map((function(t){return s.pre+y[0]+t}));if(v){var x=l(y[0]),M=l(y[1]),k=Math.max(y[0].length,y[1].length),C=3==y.length?Math.abs(l(y[2])):1,_=g;M<x&&(C*=-1,_=m);var E=y.some(d);w=[];for(var O=x;_(O,M);O+=C){var P;if(S)"\\"===(P=String.fromCharCode(O))&&(P="");else if(P=String(O),E){var D=k-P.length;if(D>0){var R=new Array(D+1).join("0");P=O<0?"-"+R+P.slice(1):R+P}}w.push(P)}}else{w=[];for(var I=0;I<y.length;I++)w.push.apply(w,f(y[I],!1))}for(I=0;I<w.length;I++)for(c=0;c<a.length;c++)h=o+w[I]+a[c],(!e||v||h)&&n.push(h)}return n}},4155:t=>{var e,n,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(e===setTimeout)return setTimeout(t,0);if((e===s||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:s}catch(t){e=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var a,c=[],l=!1,h=-1;function p(){l&&a&&(l=!1,a.length?c=a.concat(c):h=-1,c.length&&u())}function u(){if(!l){var t=r(p);l=!0;for(var e=c.length;e;){for(a=c,c=[];++h<e;)a&&a[h].run();h=-1,e=c.length}a=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||r(u)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},3200:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PinStatus=e.DiagnosticStats=e.SymbolNode=void 0;const i=n(9496),s=n(4165);class o{constructor(t){this.diagnosticStats=new r,this.kind=i.SymbolKind[t.kind],this.name=t.name,this.detail=t.detail,this.expand=!1,this.inView=!1,this.focus=!1,this.range={start:new i.Position(t.range.start.line,t.range.start.character),end:new i.Position(t.range.end.line,t.range.end.character)},this.children=[],this.selector=["#outline-root"],this.mapCustomSymbol()}mapCustomSymbol(){"Number"===this.kind&&(this.detail.startsWith("__om_Region__")?(this.kind="__om_Region__",this.detail=this.detail.slice(13)):this.detail.startsWith("__om_Tag__")&&(this.kind="__om_Tag__",this.detail=this.detail.slice(10)))}static fromDocumentSymbols(t){const e=[],n=s.config.hiddenItem();return function t(e,i){e.sort(((t,e)=>t.range.start.line-e.range.start.line)),function(t){for(let e=0;e<t.length;e++){const n=t[e];for(let i=e+1;i<t.length;i++){const e=t[i];n.range.contains(e.range)&&(n.children.push(e),t.splice(i,1),i--)}}}(e),e.forEach((e=>{const s=new o(e);n.includes(s.kind.toLowerCase())||(Array.isArray(i)?(i.push(s),s.selector=s.selector.concat(`[data-key="${s.kind}-${s.name}"]`)):(s.selector=i.selector.concat(`[data-key="${s.kind}-${s.name}"]`),i.children.push(s)),e.children.length>0&&t(e.children,s))}))}(t,e),e}}e.SymbolNode=o;class r{constructor(){this.errorCount=0,this.warningCount=0,this.hasErrorInChildren=!1,this.hasWarnInChildren=!1}clear(){this.errorCount=0,this.warningCount=0,this.hasErrorInChildren=!1,this.hasWarnInChildren=!1}add(t,e=!1){e?"error"===t?this.hasErrorInChildren=!0:this.hasWarnInChildren=!0:"error"===t?this.errorCount++:this.warningCount++}getStat(){return this.errorCount>0?{type:"error",count:this.errorCount}:this.hasErrorInChildren?{type:"error",count:-1}:this.warningCount>0?{type:"warning",count:this.warningCount}:this.hasWarnInChildren?{type:"warning",count:-1}:{type:"none",count:0}}}var a;e.DiagnosticStats=r,(a=e.PinStatus||(e.PinStatus={}))[a.unpinned=0]="unpinned",a[a.pinned=1]="pinned",a[a.frozen=2]="frozen"},7661:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceCommandList=e.OutlineViewCommandList=void 0;const i=n(9496),s=n(4165),o=n(3200);function r(t,e=1){t.postMessage({type:"changeDepth",data:{delta:e}})}function a(t,e){t.pin(e),i.commands.executeCommand("setContext","outline-map.pin-status",e)}function c(t,e,n,i){n.excludeName(i,t,e)}s.config.defaultMaxDepth()>0&&i.commands.executeCommand("setContext","outline-map.defaultMaxDepthSet",!0),i.commands.executeCommand("setContext","outline-map.pin-status",o.PinStatus.unpinned),e.OutlineViewCommandList=[{name:"outline-map.reduceDepth",fn:function(t){r(t,-1)}},{name:"outline-map.addDepth",fn:function(t){r(t,1)}},{name:"outline-map.pin",fn:function(t){a(t,o.PinStatus.pinned)}},{name:"outline-map.unpin",fn:function(t){a(t,o.PinStatus.unpinned)}},{name:"outline-map.freeze",fn:function(t){a(t,o.PinStatus.frozen)}},{name:"outline-map.toggleSearch",fn:function(t,e){e.update("searchField",!e.get("searchField",!1)),t.postMessage({type:"focus",toggle:!0})}},{name:"outline-map.focusSearch",fn:function(t,e){e.update("searchField",!0),t.postMessage({type:"focus",toggle:!1})}}],e.WorkspaceCommandList=[{name:"outline-map.workspace.closeFile",fn:function(t,e){t.removeDocuments([e.uri])}},{name:"outline-map.workspace.deleteSymbol",fn:c.bind(null,"workspace",!0)},{name:"outline-map.workspace.excludeGlobally",fn:c.bind(null,"global",!1)},{name:"outline-map.workspace.excludeInWorkspace",fn:c.bind(null,"workspace",!1)},{name:"outline-map.workspace.excludeInFolder",fn:c.bind(null,"folder",!1)},{name:"outline-map.workspace.goToLocation",fn:function(t,e,n){t.goToLocation(e,n)}}]},4165:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.config=void 0;const i=n(9496);function s(t,e="outline-map"){return i.workspace.getConfiguration(e)?.get(t)}e.config={color:()=>s("color"),follow:()=>s("follow"),hiddenItem:()=>s("hiddenItem"),defaultMaxDepth:()=>s("defaultMaxDepth"),customFont:()=>s("customFont"),customCSS:()=>s("customCSS"),debug:()=>s("debug"),regionEnabled:()=>s("enabled","outline-map.region"),regionRegisterSymbolProvider:()=>s("registerSymbolProvider","outline-map.region"),regionHighlight:()=>s("highlight","outline-map.region"),regionHighlightStyle:()=>s("highlightStyle","outline-map.region"),regionStart:()=>s("startRegion","outline-map.region"),regionEnd:()=>s("endRegion","outline-map.region"),tag:()=>s("tag","outline-map.region"),workspaceEnabled:()=>s("enabled","outline-map.workspace"),fixedFiles:()=>s("fixedFiles","outline-map.workspace"),closeFileTimeout:()=>s("closeFileTimeout","outline-map.workspace")}},2842:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OutlineTree=e.OutlineView=void 0;const i=n(4165),s=n(9496),o=n(3200),r=n(8593);e.OutlineView=class{constructor(t){this.focusing=new Set,this.prevSelections=[],this.inView=new Set,this.hasDiagnostic=new Set,this.pinStatus=o.PinStatus.unpinned,this.extensionUri=t.context.extensionUri,this.workspaceSymbols=t.workspaceSymbols,this.regionProvider=t.regionProvider,this.initialSearch=t.initialSearch||!1}pin(t){this.pinStatus=t}resolveWebviewView(t){this.view=t,this.view.webview.options={enableScripts:!0,localResourceRoots:[this.extensionUri]},this.render(),setTimeout((()=>{this.build()}),1e3),this.view.onDidChangeVisibility((()=>{this.view?.visible&&s.window.activeTextEditor&&this.build(),this.view?.visible||(this.outlineTree=void 0,this.inView.clear(),this.focusing.clear(),this.prevSelections=[])})),this.view.webview.onDidReceiveMessage((t=>{"goto"===t.type&&s.commands.executeCommand("editor.action.goToLocations",s.window.activeTextEditor?.document.uri,new s.Position(t.data.position.line,t.data.position.character),[],"goto","")}))}build(){this.update(s.window.activeTextEditor?.document||s.window.visibleTextEditors[0].document),this.postMessage({type:"config",data:{color:i.config.color(),depth:i.config.defaultMaxDepth(),debug:i.config.debug()}}),this.initialSearch&&this.postMessage({type:"focus",toggle:!1})}postMessage(t){this.view?.webview.postMessage(t)}focus(t){if(!this.outlineTree)return;if(this.pinStatus===o.PinStatus.frozen)return;const e=t.length!==this.prevSelections.length||t.some(((t,e)=>t.start.line!==this.prevSelections[e].start.line||t.end.line!==this.prevSelections[e].end.line));if(!e)return;this.prevSelections=t.slice();const n=[];for(const t of this.focusing)t.focus=!1;for(const e of t){const{inRange:t,closest:n}=this.outlineTree.findNodesIn(e);t?.forEach((t=>{t.focus=!0,this.focusing.add(t)})),0===t.length&&n&&(n.focus=!0,this.focusing.add(n))}for(const t of this.focusing)n.push({type:"update",selector:t.selector.join(" >.outline-children> "),property:"focus",value:t.focus}),t.focus||this.focusing.delete(t);this.postMessage({type:"update",data:{patches:n}})}updateViewPort(t){if(!this.outlineTree)return;if(this.pinStatus===o.PinStatus.frozen)return;const e=[];for(const t of this.inView)t.inView=!1,t.expand=!1;const{inRange:n,involves:i}=this.outlineTree.findNodesIn(t);n.forEach((t=>{t.inView=!0,t.expand=!0,this.inView.has(t)||this.inView.add(t)})),this.pinStatus===o.PinStatus.unpinned&&i.forEach((t=>{t.expand=!0,this.inView.has(t)||this.inView.add(t)}));for(const t of this.inView)e.push({type:"update",selector:t.selector.join(" >.outline-children> "),property:"inview",value:t.inView}),this.pinStatus===o.PinStatus.unpinned&&e.push({type:"update",selector:t.selector.join(" >.outline-children> "),property:"expand",value:t.expand}),t.inView||t.expand||this.inView.delete(t);this.postMessage({type:"update",data:{patches:e}})}updateDiagnostics(t){if(!this.outlineTree)return;const e=[];for(const t of this.hasDiagnostic)t.diagnosticStats.clear();t=t.filter((t=>t.severity===s.DiagnosticSeverity.Error||t.severity===s.DiagnosticSeverity.Warning)).sort(((t,e)=>t.range.start.line-e.range.start.line));let n=0;const i=e=>{if(n>=t.length)return e.diagnosticStats.getStat();const o=t[n];if(o.range.start.line>e.range.end.line)return e.diagnosticStats.getStat();if(o.range.end.line<e.range.start.line)return e.diagnosticStats.getStat();for(const t of e.children){const s=i(t);if("none"!==s.type)return e.diagnosticStats.add(s.type,!0),this.hasDiagnostic.add(e),n++,i(e),e.diagnosticStats.getStat()}return e.diagnosticStats.add(o.severity===s.DiagnosticSeverity.Error?"error":"warning",!1),this.hasDiagnostic.add(e),n++,i(e),e.diagnosticStats.getStat()};for(const t of this.outlineTree.getNodes())i(t);for(const t of this.hasDiagnostic){const n=t.diagnosticStats.getStat();e.push({type:"update",selector:t.selector.join(" >.outline-children> "),property:"diagnostictype",value:n.type},{type:"update",selector:t.selector.join(" >.outline-children> "),property:"diagnosticcount",value:n.count}),"none"===n.type&&this.hasDiagnostic.delete(t)}this.postMessage({type:"update",data:{patches:e}})}render(){if(!this.view)return;const t=t=>this.view?.webview.asWebviewUri(s.Uri.joinPath(this.extensionUri,...t.split("/")));this.view.webview.html=`\n\t\t\t<!DOCTYPE html>\n\t\t\t<html>\n\t\t\t  <head>\n\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t\x3c!-- <link href="${t("node_modules/@vscode/codicons/dist/codicon.css")}" rel="stylesheet"> --\x3e\n\t\t\t\t\x3c!-- <link href="${t("out/webview/style.css")}" rel="stylesheet"> --\x3e\n\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t\t\t\t\x3c!-- <script type="module" src="${t("node_modules/@vscode/webview-ui-toolkit/dist/toolkit.min.js")}"><\/script> --\x3e\n\t\t\t\t<title>Outline Map</title>\n\t\t\t\t<style>\n\t\t\t\t\t:not(.codicon) {\n\t\t\t\t\t\tfont-family: ${i.config.customFont()||"system-ui"}\n\t\t\t\t\t}\n\t\t\t\t\t${i.config.customCSS()}\n\t\t\t\t</style>\n\t\t\t\t<style id="color-style"></style>\n\t\t\t  </head>\n\t\t\t  <body>\n\t\t\t\t<script type="module" src="${t("out/webview/index.js")}"><\/script>\n\t\t\t  </body>\n\t\t\t</html>`}isValidDocument(t){const e=["output","vscode-scm","walkThroughSnippet"],n=t?.uri.scheme;if(!t||!n)return!1;for(const t of e)if(n.startsWith(t))return!1;return!0}update(t){if(void 0===t)return void this.clear("The active editor cannot provide outline information.");if(!this.isValidDocument(t))return;const e=new a(t,this.regionProvider);e.updateSymbols().then((()=>{const n=e.getNodes();if(!n||0===n.length)return void this.clear(`No symbols found in document '${t.fileName}'.`);this.workspaceSymbols?.updateSymbol(n,t.uri);const i=new c(this.outlineTree?.getNodes()||[],n).getOps();this.postMessage({type:"update",data:{patches:i}}),this.outlineTree=e}))}clear(t){this.outlineTree=void 0,this.inView.clear(),this.focusing.clear(),this.prevSelections=[],this.postMessage({type:"clear",data:{description:t}})}};class a{constructor(t,e){this.nodes=[],this.MAX_ATTEMPTS=10,this.attempts=0,this.textDocument=t,this.regionProvider=e}getNodes(){return this.nodes}async updateSymbols(){const t=await s.commands.executeCommand("vscode.executeDocumentSymbolProvider",this.textDocument.uri)||[],e=(0,r.deepClone)(this.regionProvider?.provideDocumentSymbols(this.textDocument,(new s.CancellationTokenSource).token));if(e&&("then"in e?t?.push(...await e||[]):t?.push(...e)),t)i.config.debug()&&console.log(`[Outline-map]: Got symbols from ${this.textDocument.uri.toString()}.`,t),this.nodes=o.SymbolNode.fromDocumentSymbols(t),this.attempts=0;else if(this.attempts<this.MAX_ATTEMPTS)this.attempts++,setTimeout((()=>this.updateSymbols()),300*this.attempts),i.config.debug()&&console.log(`Outline-map: Failed to get symbols of ${this.textDocument.uri.toString()}. Attempt ${this.attempts} of ${this.MAX_ATTEMPTS}.`);else if(i.config.debug())throw new Error(`Outline-map: Failed to get symbols of ${this.textDocument.uri.toString()}.`)}findNodesIn(t){const e=[],n=[];let i,s=Number.MAX_SAFE_INTEGER;return function o(r){let a=!1;return r.forEach((r=>{const c=r.range.start.line,l=r.range.end.line,h=t.start.line,p=t.end.line;let u=!1;if(p>=c&&h<=c&&(e.push(r),a=!0,u=!0),c<=p&&l>=h&&r.children){const t=o(r.children);a=a||t,n.push(r)}if(p<=l&&h>=c&&!a&&(e.push(r),a=!0,u=!0),!u){const t=Math.min(Math.abs(c-p),Math.abs(c-h));t<s&&(s=t,i=r)}})),a}(this.nodes),{inRange:e,involves:n,closest:i}}}e.OutlineTree=a;class c{constructor(t,e){this.ops=[],this.oldNode=t,this.newNode=e,this.patch()}getOps(){return this.ops}patch(){this.updateChildren(this.oldNode,this.newNode,["#outline-root"])}sameNode(t,e){return t.name===e.name&&t.kind===e.kind}patchNode(t,e,n){const i=["name","kind","children"],s=Object.keys(t).filter((t=>!i.includes(t))),o=n.concat(`[data-key="${e.kind}-${e.name}"]`).join(" >.outline-children> ");for(const n of s){const i=Object.getOwnPropertyDescriptor(t,n)?.value,s=Object.getOwnPropertyDescriptor(e,n)?.value;"expand"!==n?JSON.stringify(i)!==JSON.stringify(s)&&this.ops.push({selector:o,type:"update",property:n,value:"object"==typeof s?JSON.stringify(s):s}):e.expand=i}const r=t.children&&t.children.length>0,a=e.children&&e.children.length>0;r&&a?this.updateChildren(t.children,e.children,n.concat(`[data-key="${e.kind}-${e.name}"]`)):r&&!a?this.ops.push({selector:o,type:"delete",nodes:t.children}):!r&&a&&this.ops.push({selector:o,type:"insert",before:null,nodes:e.children})}updateChildren(t,e,n){let i=0,s=0,o=t.length-1,r=e.length-1,a=t[i],c=e[s],l=t[o],h=e[r];const p=n.join(" >.outline-children> ");for(;i<=o&&s<=r;)if(this.sameNode(a,c))this.patchNode(a,c,n),a=t[++i],c=e[++s];else if(this.sameNode(l,h))this.patchNode(l,h,n),l=t[--o],h=e[--r];else if(this.sameNode(a,h))this.patchNode(a,h,n),this.ops.push({selector:p,type:"move",nodes:[a],before:t[o+1]||null}),a=t[++i],h=e[--r];else if(this.sameNode(l,c))this.patchNode(l,c,n),this.ops.push({selector:p,type:"move",nodes:[l],before:t[i]||null}),l=t[--o],c=e[++s];else{const e=t.findIndex((t=>this.sameNode(t,c)));if(!(e>=0)){this.ops.push({selector:p,type:"insert",nodes:[c],before:t[i]}),s++;break}this.patchNode(t[e],c,n),this.ops.push({selector:p,type:"move",nodes:[t[e]],before:t[i]||null}),t.splice(e,1)}i<=o&&this.ops.push({selector:p,type:"delete",nodes:t.slice(i,o+1)}),s<=r&&this.ops.push({selector:p,type:"insert",nodes:e.slice(s,r+1),before:t[i]||null})}}},2:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RegionProvider=void 0;const i=n(9496),s=n(4165);e.RegionProvider=class{constructor(){this.documentVersion=0,this.regions=[],this.tags=[],this.symbols=[],this.folding=[],this.startRegion=s.config.regionStart(),this.endRegion=s.config.regionEnd(),this.tag=s.config.tag();const t=s.config.regionHighlightStyle();this.keyDecorationType=i.window.createTextEditorDecorationType(t?.key||{color:new i.ThemeColor("symbolIcon.keywordForeground")}),this.nameDecorationType=i.window.createTextEditorDecorationType(t?.name||{color:new i.ThemeColor("symbolIcon.variableForeground")}),this.descriptionDecorationType=i.window.createTextEditorDecorationType(t?.description||{})}updateDecorationsConfig(){const t=s.config.regionHighlightStyle();this.keyDecorationType.dispose(),this.keyDecorationType=i.window.createTextEditorDecorationType(t?.key||{color:new i.ThemeColor("symbolIcon.keywordForeground")}),this.nameDecorationType.dispose(),this.nameDecorationType=i.window.createTextEditorDecorationType(t?.name||{color:new i.ThemeColor("symbolIcon.variableForeground")}),this.descriptionDecorationType.dispose(),this.descriptionDecorationType=i.window.createTextEditorDecorationType(t?.description||{})}clear(){this.regions=[],this.tags=[],this.symbols=[],this.folding=[]}update(t,e){t===this.document&&t.version===this.documentVersion||(this.document=t,this.documentVersion=t.version,this.parseDocument(e))}parseDocument(t){if(!this.document)return;this.startRegion=s.config.regionStart(),this.endRegion=s.config.regionEnd(),this.tag=s.config.tag(),this.clear();const e=[],n=[],i=[];for(let s=0;s<this.document.lineCount;s++){if(t&&t.isCancellationRequested)return;const o=this.document.lineAt(s);if(o.isEmptyOrWhitespace)continue;const r=this.matchLine(o.text,s);if(!r)continue;if("region-end"!==r.type&&r.name){("tag"===r.type?i:e).push({name:r.name,at:o.range,key:r.key,description:r.description});continue}let a=e.length-1;if(r.name){for(let t=e.length-1;t>=0;t--)if(e[t].name===r.name){a=t;break}if(-1===a)continue}const c=e[a];c&&(e.splice(a,1),n.push({key:c.key,keyEnd:r.key,name:c.name,nameEnd:r.name,start:c.at,end:o.range,description:c.description}))}this.regions=n,this.tags=i,this.updateSymbols(),this.updateFolding(),this.updateDecorations()}updateSymbols(){for(const t of this.regions){const e=new i.DocumentSymbol(t.name.text,`__om_Region__${t.description?.text||""}`,i.SymbolKind.Number,new i.Range(t.start.start,t.end.end),new i.Range(t.name.range.start,t.name.range.end));this.symbols.push(e)}for(const t of this.tags){const e=new i.DocumentSymbol(t.name.text,`__om_Tag__${t.description?.text||""}`,i.SymbolKind.Number,t.at,t.name.range);this.symbols.push(e)}}updateFolding(){for(const t of this.regions)this.folding.push(new i.FoldingRange(t.start.start.line,t.end.end.line))}updateDecorations(){const t=i.window.activeTextEditor;if(!t)return;const e=[],n=[],s=[];this.regions.forEach((t=>{e.push({range:t.key.range},{range:t.keyEnd.range}),n.push({range:t.name.range,hoverMessage:`${t.key.text} **${t.name.text}** ${t.description?.text||""}`},...t.nameEnd?[{range:t.nameEnd.range,hoverMessage:`${t.key.text} **${t.name.text}** ${t.description?.text||""}`}]:[]),t.description&&s.push({range:t.description.range})})),this.tags.forEach((t=>{e.push({range:t.key.range}),n.push({range:t.name.range,hoverMessage:`${t.key.text} **${t.name.text}** ${t.description?.text||""}`}),t.description&&s.push({range:t.description.range})})),t.setDecorations(this.keyDecorationType,e),t.setDecorations(this.nameDecorationType,n),t.setDecorations(this.descriptionDecorationType,s)}provideFoldingRanges(t,e,n){if(!n.isCancellationRequested)return this.update(t,n),this.folding}provideDocumentSymbols(t,e){if(!e.isCancellationRequested)return this.update(t,e),this.symbols}matchLine(t,e){return this.matchStart(t,e)||this.matchEnd(t,e)||this.matchTag(t,e)}matchStart(t,e){const n=new RegExp(`${this.startRegion}[\\t ]+(?<name>[\\S]*)[\\t ]*(?<description>.*)`),i=t.match(n);return i?this.getTokens(i,this.startRegion,e,"region-start"):null}matchEnd(t,e){const n=new RegExp(`${this.endRegion}([\t ]+(?<name>[\\S]*))?`),i=t.match(n);return i?this.getTokens(i,this.endRegion,e,"region-end"):null}matchTag(t,e){const n=new RegExp(`${this.tag}[\\t ]+(?<name>[\\S]*)[\\t ]*(?<description>.*)`),i=t.match(n);return i?this.getTokens(i,this.tag,e,"tag"):null}getTokens(t,e,n,s){let o=t.index||0;const r={type:s,key:{type:"key",text:e,range:new i.Range(new i.Position(n,o),new i.Position(n,o+e.length))}},a=t.groups?.name||null;if(!a)return r;o=(t.index||0)+t[0].indexOf(t.groups?.name||"",e.length),r.name={type:"name",text:a,range:new i.Range(new i.Position(n,o),new i.Position(n,o+a.length))};const c=t.groups?.description||null;return c?(o=(t.index||0)+t[0].lastIndexOf(c),r.description={type:"description",text:c,range:new i.Range(new i.Position(n,o),new i.Position(n,o+c.length))},r):r}}},120:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbols=e.SymbolTreeItem=void 0;const i=n(9496),s=n(8593),o=n(4165);n(8457);const r=n(8457),a=n(2842);class c extends i.TreeItem{constructor(t,e,n=!0){if(super(t.name,t.children.length>0?i.TreeItemCollapsibleState.Collapsed:i.TreeItemCollapsibleState.None),this.children=[],this.inner=t,this.uri=e,this.contextValue=t.type,"file"===t.type){const n=t.name?.split("/");this.label=n.pop(),n[0],this.description=n.join("/"),this.tooltip=e.path,this.iconPath=i.ThemeIcon.File,this.resourceUri=e}else this.iconPath=new i.ThemeIcon((0,s.mapIcon)(t.kind),new i.ThemeColor(s.ColorTable[t.kind])),this.command={title:"Jump to",command:"outline-map.workspace.goToLocation",arguments:[this.uri.toString(),new i.Position(t.range.start.line,t.range.start.char)]};n&&(this.children=t.children.map((t=>new c(t,e))))}}e.SymbolTreeItem=c,e.WorkspaceSymbols=class{constructor(t,e){this.IncludeSymbols=new Set(["__om_Tag__","__om_Region__"]),this.IncludeNames=[],this.excludes=[],this.entryMap=new Map,this.filepathMap=new Map,this.workspaceFolders=[],this._onDidChangeTreeData=new i.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.state=t,this.entryMap=new Map,this.workspaceFolders=e,this.updateConfig();const n=this.state.get("workspace-symbols");if(n){this.entryMap=new Map(n);for(const[t,e]of n)0===e.children.length&&this.entryMap.delete(t)}this.skipCloseTime()}goToLocation(t,e){this.entryMap.has(t)&&(this.entryMap.get(t).lastClick=Date.now(),0!==o.config.fixedFiles()&&this.entryMap.get(t).order>=o.config.fixedFiles()&&this.updateOrder(),o.config.closeFileTimeout()>0&&this.checkCloseFile(),i.commands.executeCommand("editor.action.goToLocations",i.Uri.parse(t),e,[],"goto",""))}updateOrder(){Array.from(this.entryMap.entries()).sort(((t,e)=>(e[1].lastClick||0)-(t[1].lastClick||0))).map((t=>t[0])).forEach(((t,e)=>{this.entryMap.get(t).order=e})),this._onDidChangeTreeData.fire()}skipCloseTime(){const t=Date.now(),e=t-this.state.get("time-stamp",t);this.entryMap.forEach((t=>{t.lastClick=t.lastClick?t.lastClick+e:0})),this.updateCurrentTime()}updateCurrentTime(){this.state.update("time-stamp",Date.now()).then((()=>{setTimeout((()=>{this.updateCurrentTime()}),1e3)}))}checkCloseFile(){const t=1e3*o.config.closeFileTimeout();if(t<=0)return;const e=Date.now(),n=[];this.entryMap.forEach(((i,s)=>{i.lastClick&&e-i.lastClick>t&&n.push(s)})),n.length>0&&this.removeDocuments(n.map((t=>i.Uri.parse(t))))}excludeName(t,e,n=!1){const s={},o=this.mapDocumentUri(t.uri);"symbol"===t.inner.type&&(s.symbol=t.inner.name),("file"===t.inner.type||n)&&(s.file=o);const r=i.workspace.getConfiguration("outline-map.workspace"),a=r.inspect("excludes"),c=a?.["global"===e?"globalValue":"workspaceValue"]||[];r.update("excludes",[...c,s],"global"===e||"workspace"!==e&&null).then((()=>{"file"===t.inner.type?this.removeDocuments([t.uri]):this.reloadSymbolsOf(t.uri)}))}updateConfig(){const t=i.workspace.getConfiguration("outline-map.workspace");this.excludes=t.get("excludes")||[],this.IncludeNames=t.get("IncludeNames")||[];const e=t.get("IncludeSymbols")||[];this.IncludeSymbols=new Set(e)}matchConfig(t,e){const n=this.mapDocumentUri(t.uri),i=t.inner.name;if("file"===t.inner.type){for(const t of e)if(!t.symbol&&(0,r.minimatch)(n,t.file))return!0}else for(const t of e)if(t.symbol&&(0,r.minimatch)(i,t.symbol)&&(!t.file||(0,r.minimatch)(n,t.file)))return!0;return!1}init(){this.state.update("workspace-symbols",[])}apply(){this.state.update("workspace-symbols",[...this.entryMap]),this._onDidChangeTreeData.fire()}mapDocumentUri(t){if(1===this.workspaceFolders.length)return t.path.replace(this.workspaceFolders[0].path,"");for(const e of this.workspaceFolders)if(t.path.startsWith(e.path)){const n=e.path.split("/").pop()||"";return t.path.replace(e.path,n)}return t.path}reloadSymbolsOf(t){this.entryMap.has(t.toString())&&i.workspace.openTextDocument(t).then((e=>{const n=new a.OutlineTree(e);n.updateSymbols().then((()=>{this.updateSymbol(n.getNodes(),t)}))}))}updateSymbol(t,e){const n=e.toString();let i=this.entryMap.get(n);if(i||(i={type:"file",name:this.mapDocumentUri(e),children:[],uri:n,order:this.entryMap.size,lastClick:0}),this.matchConfig(new c(i,e,!1),this.excludes))return;const s=this.mapSymbolNode(t,e);s&&0!==s.length?(i.children=s,this.entryMap.set(n,i),this.apply()):this.entryMap.has(n)&&(this.entryMap.delete(n),this.apply())}removeDocuments(t){let e=!1;for(const n of t){const t=n.toString();this.entryMap.has(t)&&(this.entryMap.delete(t),this.updateOrder(),e=!0)}e&&this.apply()}renameDocuments(t){let e=!1;for(const n of t){const t=n.oldUri.toString(),i=n.newUri.toString();if(this.entryMap.has(t)){e=!0;const n=this.entryMap.get(t);this.entryMap.delete(t),this.entryMap.set(i,n)}}e&&this.apply()}mapSymbolNode(t,e){const n=t=>{const i={type:"symbol",name:t.name,detail:t.detail,kind:t.kind,range:{start:{line:t.range.start.line,char:t.range.start.character},end:{line:t.range.end.line,char:t.range.end.character}},children:[]},s=new c(i,e,!1);if(this.matchConfig(s,this.excludes))return null;for(const e of t.children){const t=n(e);t&&i.children.push(t)}return 0!==i.children.length||this.IncludeSymbols.has(t.kind)||this.matchConfig(s,this.IncludeNames)?i:null},i=[];for(const e of t){const t=n(e);t&&i.push(t)}return i}getTreeItem(t){return t}getChildren(t){return t?t.children:Array.from(this.entryMap.values()).sort(((t,e)=>t.order-e.order)).map((t=>new c(t,i.Uri.parse(t.uri))))}}},8593:(t,e)=>{"use strict";function n(t){return t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}Object.defineProperty(e,"__esModule",{value:!0}),e.deepClone=e.mapIcon=e.camelToDash=e.throttle=e.debounce=e.ColorTable=e.SymbolKindList=void 0,e.SymbolKindList=["File","Module","Namespace","Package","Class","Method","Property","Field","Constructor","Enum","Interface","Function","Variable","Constant","String","Number","Boolean","Array","Object","Key","Null","EnumMember","Struct","Event","Operator","TypeParameter","__om_Tag__","__om_Region__"],e.ColorTable={File:"symbolIcon.fileForeground",Module:"symbolIcon.moduleForeground",Namespace:"symbolIcon.namespaceForeground",Package:"symbolIcon.packageForeground",Class:"symbolIcon.classForeground",Method:"symbolIcon.methodForeground",Property:"symbolIcon.propertyForeground",Field:"symbolIcon.fieldForeground",Constructor:"symbolIcon.constructorForeground",Enum:"symbolIcon.enumeratorForeground",Interface:"symbolIcon.interfaceForeground",Function:"symbolIcon.functionForeground",Variable:"symbolIcon.variableForeground",Constant:"symbolIcon.constantForeground",String:"symbolIcon.stringForeground",Number:"symbolIcon.numberForeground",Boolean:"symbolIcon.booleanForeground",Array:"symbolIcon.arrayForeground",Object:"symbolIcon.objectForeground",Key:"symbolIcon.keyForeground",Null:"symbolIcon.nullForeground",EnumMember:"symbolIcon.enumeratorMemberForeground",Struct:"symbolIcon.structForeground",Event:"symbolIcon.eventForeground",Operator:"symbolIcon.operatorForeground",TypeParameter:"symbolIcon.typeParameterForeground",__om_Tag__:"symbolIcon.om_TagForeground",__om_Region__:"symbolIcon.om_RegionForeground",visibleRange:"outlineMap.visibleRangeBackground",focusingItem:"outlineMap.focusingItemBackground"},e.debounce=function(t,e){let n=null;return function(...i){n&&clearTimeout(n),n=setTimeout((()=>{t.apply(this,i)}),e)}},e.throttle=function(t,e){let n=!1;return function(...i){n||(t.apply(this,i),n=!0,setTimeout((()=>n=!1),e))}},e.camelToDash=n,e.mapIcon=function(t){let e=`symbol-${n(t)}`;return"__om_Region__"===t&&(e="folder"),"__om_Tag__"===t&&(e="tag"),e},e.deepClone=function t(e){if(null===e||"object"!=typeof e)return e;let n;if(Array.isArray(e)){n=[];for(let i=0;i<e.length;i++)n[i]=t(e[i])}else{const i=Object.getPrototypeOf(e);n=Object.create(i),Object.getOwnPropertyNames(e).forEach((i=>{const s=Object.getOwnPropertyDescriptor(e,i);s&&s.get?n[i]=s.get.call(e):n[i]=t(e[i])}))}return n}},9496:t=>{"use strict";t.exports=require("vscode")},9216:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertValidPattern=void 0,e.assertValidPattern=t=>{if("string"!=typeof t)throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")}},9767:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AST=void 0;const i=n(9929),s=n(4023),o=new Set(["!","?","+","*","@"]),r=t=>o.has(t),a="(?!\\.)",c=new Set(["[","."]),l=new Set(["..","."]),h=new Set("().*{}+?[]^$\\!"),p="[^/]",u=p+"*?",d=p+"+?";class g{type;#t;#e;#n=!1;#i=[];#s;#o;#r;#a=!1;#c;#l;#h=!1;constructor(t,e,n={}){this.type=t,t&&(this.#e=!0),this.#s=e,this.#t=this.#s?this.#s.#t:this,this.#c=this.#t===this?n:this.#t.#c,this.#r=this.#t===this?[]:this.#t.#r,"!"!==t||this.#t.#a||this.#r.push(this),this.#o=this.#s?this.#s.#i.length:0}get hasMagic(){if(void 0!==this.#e)return this.#e;for(const t of this.#i)if("string"!=typeof t&&(t.type||t.hasMagic))return this.#e=!0;return this.#e}toString(){return void 0!==this.#l?this.#l:this.type?this.#l=this.type+"("+this.#i.map((t=>String(t))).join("|")+")":this.#l=this.#i.map((t=>String(t))).join("")}#p(){if(this!==this.#t)throw new Error("should only call on root");if(this.#a)return this;let t;for(this.toString(),this.#a=!0;t=this.#r.pop();){if("!"!==t.type)continue;let e=t,n=e.#s;for(;n;){for(let i=e.#o+1;!n.type&&i<n.#i.length;i++)for(const e of t.#i){if("string"==typeof e)throw new Error("string part in extglob AST??");e.copyIn(n.#i[i])}e=n,n=e.#s}}return this}push(...t){for(const e of t)if(""!==e){if("string"!=typeof e&&!(e instanceof g&&e.#s===this))throw new Error("invalid part: "+e);this.#i.push(e)}}toJSON(){const t=null===this.type?this.#i.slice().map((t=>"string"==typeof t?t:t.toJSON())):[this.type,...this.#i.map((t=>t.toJSON()))];return this.isStart()&&!this.type&&t.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#a&&"!"===this.#s?.type)&&t.push({}),t}isStart(){if(this.#t===this)return!0;if(!this.#s?.isStart())return!1;if(0===this.#o)return!0;const t=this.#s;for(let e=0;e<this.#o;e++){const n=t.#i[e];if(!(n instanceof g&&"!"===n.type))return!1}return!0}isEnd(){if(this.#t===this)return!0;if("!"===this.#s?.type)return!0;if(!this.#s?.isEnd())return!1;if(!this.type)return this.#s?.isEnd();const t=this.#s?this.#s.#i.length:0;return this.#o===t-1}copyIn(t){"string"==typeof t?this.push(t):this.push(t.clone(this))}clone(t){const e=new g(this.type,t);for(const t of this.#i)e.copyIn(t);return e}static#u(t,e,n,i){let s=!1,o=!1,a=-1,c=!1;if(null===e.type){let l=n,h="";for(;l<t.length;){const n=t.charAt(l++);if(s||"\\"===n)s=!s,h+=n;else if(o)l===a+1?"^"!==n&&"!"!==n||(c=!0):"]"!==n||l===a+2&&c||(o=!1),h+=n;else if("["!==n)if(i.noext||!r(n)||"("!==t.charAt(l))h+=n;else{e.push(h),h="";const s=new g(n,e);l=g.#u(t,s,l,i),e.push(s)}else o=!0,a=l,c=!1,h+=n}return e.push(h),l}let l=n+1,h=new g(null,e);const p=[];let u="";for(;l<t.length;){const n=t.charAt(l++);if(s||"\\"===n)s=!s,u+=n;else if(o)l===a+1?"^"!==n&&"!"!==n||(c=!0):"]"!==n||l===a+2&&c||(o=!1),u+=n;else if("["!==n)if(r(n)&&"("===t.charAt(l)){h.push(u),u="";const e=new g(n,h);h.push(e),l=g.#u(t,e,l,i)}else if("|"!==n){if(")"===n)return""===u&&0===e.#i.length&&(e.#h=!0),h.push(u),u="",e.push(...p,h),l;u+=n}else h.push(u),u="",p.push(h),h=new g(null,e);else o=!0,a=l,c=!1,u+=n}return e.type=null,e.#e=void 0,e.#i=[t.substring(n-1)],l}static fromGlob(t,e={}){const n=new g(null,void 0,e);return g.#u(t,n,0,e),n}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();const t=this.toString(),[e,n,i,s]=this.toRegExpSource();if(!(i||this.#e||this.#c.nocase&&!this.#c.nocaseMagicOnly&&t.toUpperCase()!==t.toLowerCase()))return n;const o=(this.#c.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${e}$`,o),{_src:e,_glob:t})}toRegExpSource(t){const e=t??!!this.#c.dot;if(this.#t===this&&this.#p(),!this.type){const n=this.isStart()&&this.isEnd(),i=this.#i.map((e=>{const[i,s,o,r]="string"==typeof e?g.#d(e,this.#e,n):e.toRegExpSource(t);return this.#e=this.#e||o,this.#n=this.#n||r,i})).join("");let o="";if(this.isStart()&&"string"==typeof this.#i[0]&&(1!==this.#i.length||!l.has(this.#i[0]))){const n=c,s=e&&n.has(i.charAt(0))||i.startsWith("\\.")&&n.has(i.charAt(2))||i.startsWith("\\.\\.")&&n.has(i.charAt(4)),r=!e&&!t&&n.has(i.charAt(0));o=s?"(?!(?:^|/)\\.\\.?(?:$|/))":r?a:""}let r="";return this.isEnd()&&this.#t.#a&&"!"===this.#s?.type&&(r="(?:$|\\/)"),[o+i+r,(0,s.unescape)(i),this.#e=!!this.#e,this.#n]}const n="*"===this.type||"+"===this.type,i="!"===this.type?"(?:(?!(?:":"(?:";let o=this.#g(e);if(this.isStart()&&this.isEnd()&&!o&&"!"!==this.type){const t=this.toString();return this.#i=[t],this.type=null,this.#e=void 0,[t,(0,s.unescape)(this.toString()),!1,!1]}let r=!n||t||e?"":this.#g(!0);r===o&&(r=""),r&&(o=`(?:${o})(?:${r})*?`);let h="";return h="!"===this.type&&this.#h?(this.isStart()&&!e?a:"")+d:i+o+("!"===this.type?"))"+(!this.isStart()||e||t?"":a)+u+")":"@"===this.type?")":"?"===this.type?")?":"+"===this.type&&r?")":"*"===this.type&&r?")?":`)${this.type}`),[h,(0,s.unescape)(o),this.#e=!!this.#e,this.#n]}#g(t){return this.#i.map((e=>{if("string"==typeof e)throw new Error("string type in extglob ast??");const[n,i,s,o]=e.toRegExpSource(t);return this.#n=this.#n||o,n})).filter((t=>!(this.isStart()&&this.isEnd()&&!t))).join("|")}static#d(t,e,n=!1){let o=!1,r="",a=!1;for(let s=0;s<t.length;s++){const c=t.charAt(s);if(o)o=!1,r+=(h.has(c)?"\\":"")+c;else if("\\"!==c){if("["===c){const[n,o,c,l]=(0,i.parseClass)(t,s);if(c){r+=n,a=a||o,s+=c-1,e=e||l;continue}}"*"!==c?"?"!==c?r+=c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):(r+=p,e=!0):(r+=n&&"*"===t?d:u,e=!0)}else s===t.length-1?r+="\\\\":o=!0}return[r,(0,s.unescape)(t),!!e,a]}}e.AST=g},9929:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseClass=void 0;const n={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},i=t=>t.replace(/[[\]\\-]/g,"\\$&"),s=t=>t.join("");e.parseClass=(t,e)=>{const o=e;if("["!==t.charAt(o))throw new Error("not in a brace expression");const r=[],a=[];let c=o+1,l=!1,h=!1,p=!1,u=!1,d=o,g="";t:for(;c<t.length;){const e=t.charAt(c);if("!"!==e&&"^"!==e||c!==o+1){if("]"===e&&l&&!p){d=c+1;break}if(l=!0,"\\"!==e||p){if("["===e&&!p)for(const[e,[i,s,l]]of Object.entries(n))if(t.startsWith(e,c)){if(g)return["$.",!1,t.length-o,!0];c+=e.length,l?a.push(i):r.push(i),h=h||s;continue t}p=!1,g?(e>g?r.push(i(g)+"-"+i(e)):e===g&&r.push(i(e)),g="",c++):t.startsWith("-]",c+1)?(r.push(i(e+"-")),c+=2):t.startsWith("-",c+1)?(g=e,c+=2):(r.push(i(e)),c++)}else p=!0,c++}else u=!0,c++}if(d<c)return["",!1,0,!1];if(!r.length&&!a.length)return["$.",!1,t.length-o,!0];if(0===a.length&&1===r.length&&/^\\?.$/.test(r[0])&&!u){return[(m=2===r[0].length?r[0].slice(-1):r[0],m.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,d-o,!1]}var m;const f="["+(u?"^":"")+s(r)+"]",y="["+(u?"":"^")+s(a)+"]";return[r.length&&a.length?"("+f+"|"+y+")":r.length?f:y,h,d-o,!0]}},4820:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.escape=void 0,e.escape=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&")},8457:function(t,e,n){"use strict";var i=n(4155),s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.unescape=e.escape=e.AST=e.Minimatch=e.match=e.makeRe=e.braceExpand=e.defaults=e.filter=e.GLOBSTAR=e.sep=e.minimatch=void 0;const o=s(n(3644)),r=n(9216),a=n(9767),c=n(4820),l=n(4023);e.minimatch=(t,e,n={})=>((0,r.assertValidPattern)(e),!(!n.nocomment&&"#"===e.charAt(0))&&new I(e,n).match(t));const h=/^\*+([^+@!?\*\[\(]*)$/,p=t=>e=>!e.startsWith(".")&&e.endsWith(t),u=t=>e=>e.endsWith(t),d=t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),g=t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),m=/^\*+\.\*+$/,f=t=>!t.startsWith(".")&&t.includes("."),y=t=>"."!==t&&".."!==t&&t.includes("."),w=/^\.\*+$/,b=t=>"."!==t&&".."!==t&&t.startsWith("."),S=/^\*+$/,v=t=>0!==t.length&&!t.startsWith("."),T=t=>0!==t.length&&"."!==t&&".."!==t,x=/^\?+([^+@!?\*\[\(]*)?$/,M=([t,e=""])=>{const n=E([t]);return e?(e=e.toLowerCase(),t=>n(t)&&t.toLowerCase().endsWith(e)):n},k=([t,e=""])=>{const n=O([t]);return e?(e=e.toLowerCase(),t=>n(t)&&t.toLowerCase().endsWith(e)):n},C=([t,e=""])=>{const n=O([t]);return e?t=>n(t)&&t.endsWith(e):n},_=([t,e=""])=>{const n=E([t]);return e?t=>n(t)&&t.endsWith(e):n},E=([t])=>{const e=t.length;return t=>t.length===e&&!t.startsWith(".")},O=([t])=>{const e=t.length;return t=>t.length===e&&"."!==t&&".."!==t},P="object"==typeof i&&i?"object"==typeof i.env&&i.env&&i.env.__MINIMATCH_TESTING_PLATFORM__||i.platform:"posix";e.sep="win32"===P?"\\":"/",e.minimatch.sep=e.sep,e.GLOBSTAR=Symbol("globstar **"),e.minimatch.GLOBSTAR=e.GLOBSTAR,e.filter=(t,n={})=>i=>(0,e.minimatch)(i,t,n),e.minimatch.filter=e.filter;const D=(t,e={})=>Object.assign({},t,e);e.defaults=t=>{if(!t||"object"!=typeof t||!Object.keys(t).length)return e.minimatch;const n=e.minimatch;return Object.assign(((e,i,s={})=>n(e,i,D(t,s))),{Minimatch:class extends n.Minimatch{constructor(e,n={}){super(e,D(t,n))}static defaults(e){return n.defaults(D(t,e)).Minimatch}},AST:class extends n.AST{constructor(e,n,i={}){super(e,n,D(t,i))}static fromGlob(e,i={}){return n.AST.fromGlob(e,D(t,i))}},unescape:(e,i={})=>n.unescape(e,D(t,i)),escape:(e,i={})=>n.escape(e,D(t,i)),filter:(e,i={})=>n.filter(e,D(t,i)),defaults:e=>n.defaults(D(t,e)),makeRe:(e,i={})=>n.makeRe(e,D(t,i)),braceExpand:(e,i={})=>n.braceExpand(e,D(t,i)),match:(e,i,s={})=>n.match(e,i,D(t,s)),sep:n.sep,GLOBSTAR:e.GLOBSTAR})},e.minimatch.defaults=e.defaults,e.braceExpand=(t,e={})=>((0,r.assertValidPattern)(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:(0,o.default)(t)),e.minimatch.braceExpand=e.braceExpand,e.makeRe=(t,e={})=>new I(t,e).makeRe(),e.minimatch.makeRe=e.makeRe,e.match=(t,e,n={})=>{const i=new I(e,n);return t=t.filter((t=>i.match(t))),i.options.nonull&&!t.length&&t.push(e),t},e.minimatch.match=e.match;const R=/[?*]|[+@!]\(.*?\)|\[|\]/;class I{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(t,e={}){(0,r.assertValidPattern)(t),e=e||{},this.options=e,this.pattern=t,this.platform=e.platform||P,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||!1===e.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!e.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!e.nonegate,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==e.windowsNoMagicRoot?e.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const t of this.set)for(const e of t)if("string"!=typeof e)return!0;return!1}debug(...t){}make(){const t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],e.debug&&(this.debug=(...t)=>console.error(...t)),this.debug(this.pattern,this.globSet);const n=this.globSet.map((t=>this.slashSplit(t)));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let i=this.globParts.map(((t,e,n)=>{if(this.isWindows&&this.windowsNoMagicRoot){const e=!(""!==t[0]||""!==t[1]||"?"!==t[2]&&R.test(t[2])||R.test(t[3])),n=/^[a-z]:/i.test(t[0]);if(e)return[...t.slice(0,4),...t.slice(4).map((t=>this.parse(t)))];if(n)return[t[0],...t.slice(1).map((t=>this.parse(t)))]}return t.map((t=>this.parse(t)))}));if(this.debug(this.pattern,i),this.set=i.filter((t=>-1===t.indexOf(!1))),this.isWindows)for(let t=0;t<this.set.length;t++){const e=this.set[t];""===e[0]&&""===e[1]&&"?"===this.globParts[t][2]&&"string"==typeof e[3]&&/^[a-z]:$/i.test(e[3])&&(e[2]="?")}this.debug(this.pattern,this.set)}preprocess(t){if(this.options.noglobstar)for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++)"**"===t[e][n]&&(t[e][n]="*");const{optimizationLevel:e=1}=this.options;return e>=2?(t=this.firstPhasePreProcess(t),t=this.secondPhasePreProcess(t)):t=e>=1?this.levelOneOptimize(t):this.adjascentGlobstarOptimize(t),t}adjascentGlobstarOptimize(t){return t.map((t=>{let e=-1;for(;-1!==(e=t.indexOf("**",e+1));){let n=e;for(;"**"===t[n+1];)n++;n!==e&&t.splice(e,n-e)}return t}))}levelOneOptimize(t){return t.map((t=>0===(t=t.reduce(((t,e)=>{const n=t[t.length-1];return"**"===e&&"**"===n?t:".."===e&&n&&".."!==n&&"."!==n&&"**"!==n?(t.pop(),t):(t.push(e),t)}),[])).length?[""]:t))}levelTwoFileOptimize(t){Array.isArray(t)||(t=this.slashSplit(t));let e=!1;do{if(e=!1,!this.preserveMultipleSlashes){for(let n=1;n<t.length-1;n++){const i=t[n];1===n&&""===i&&""===t[0]||"."!==i&&""!==i||(e=!0,t.splice(n,1),n--)}"."!==t[0]||2!==t.length||"."!==t[1]&&""!==t[1]||(e=!0,t.pop())}let n=0;for(;-1!==(n=t.indexOf("..",n+1));){const i=t[n-1];i&&"."!==i&&".."!==i&&"**"!==i&&(e=!0,t.splice(n-1,2),n-=2)}}while(e);return 0===t.length?[""]:t}firstPhasePreProcess(t){let e=!1;do{e=!1;for(let n of t){let i=-1;for(;-1!==(i=n.indexOf("**",i+1));){let s=i;for(;"**"===n[s+1];)s++;s>i&&n.splice(i+1,s-i);let o=n[i+1];const r=n[i+2],a=n[i+3];if(".."!==o)continue;if(!r||"."===r||".."===r||!a||"."===a||".."===a)continue;e=!0,n.splice(i,1);const c=n.slice(0);c[i]="**",t.push(c),i--}if(!this.preserveMultipleSlashes){for(let t=1;t<n.length-1;t++){const i=n[t];1===t&&""===i&&""===n[0]||"."!==i&&""!==i||(e=!0,n.splice(t,1),t--)}"."!==n[0]||2!==n.length||"."!==n[1]&&""!==n[1]||(e=!0,n.pop())}let s=0;for(;-1!==(s=n.indexOf("..",s+1));){const t=n[s-1];if(t&&"."!==t&&".."!==t&&"**"!==t){e=!0;const t=1===s&&"**"===n[s+1]?["."]:[];n.splice(s-1,2,...t),0===n.length&&n.push(""),s-=2}}}}while(e);return t}secondPhasePreProcess(t){for(let e=0;e<t.length-1;e++)for(let n=e+1;n<t.length;n++){const i=this.partsMatch(t[e],t[n],!this.preserveMultipleSlashes);i&&(t[e]=i,t[n]=[])}return t.filter((t=>t.length))}partsMatch(t,e,n=!1){let i=0,s=0,o=[],r="";for(;i<t.length&&s<e.length;)if(t[i]===e[s])o.push("b"===r?e[s]:t[i]),i++,s++;else if(n&&"**"===t[i]&&e[s]===t[i+1])o.push(t[i]),i++;else if(n&&"**"===e[s]&&t[i]===e[s+1])o.push(e[s]),s++;else if("*"!==t[i]||!e[s]||!this.options.dot&&e[s].startsWith(".")||"**"===e[s]){if("*"!==e[s]||!t[i]||!this.options.dot&&t[i].startsWith(".")||"**"===t[i])return!1;if("a"===r)return!1;r="b",o.push(e[s]),i++,s++}else{if("b"===r)return!1;r="a",o.push(t[i]),i++,s++}return t.length===e.length&&o}parseNegate(){if(this.nonegate)return;const t=this.pattern;let e=!1,n=0;for(let i=0;i<t.length&&"!"===t.charAt(i);i++)e=!e,n++;n&&(this.pattern=t.slice(n)),this.negate=e}matchOne(t,n,i=!1){const s=this.options;if(this.isWindows){const e="string"==typeof t[0]&&/^[a-z]:$/i.test(t[0]),i=!e&&""===t[0]&&""===t[1]&&"?"===t[2]&&/^[a-z]:$/i.test(t[3]),s="string"==typeof n[0]&&/^[a-z]:$/i.test(n[0]),o=i?3:e?0:void 0,r=!s&&""===n[0]&&""===n[1]&&"?"===n[2]&&"string"==typeof n[3]&&/^[a-z]:$/i.test(n[3])?3:s?0:void 0;if("number"==typeof o&&"number"==typeof r){const[e,i]=[t[o],n[r]];e.toLowerCase()===i.toLowerCase()&&(n[r]=e,r>o?n=n.slice(r):o>r&&(t=t.slice(o)))}}const{optimizationLevel:o=1}=this.options;o>=2&&(t=this.levelTwoFileOptimize(t)),this.debug("matchOne",this,{file:t,pattern:n}),this.debug("matchOne",t.length,n.length);for(var r=0,a=0,c=t.length,l=n.length;r<c&&a<l;r++,a++){this.debug("matchOne loop");var h=n[a],p=t[r];if(this.debug(n,h,p),!1===h)return!1;if(h===e.GLOBSTAR){this.debug("GLOBSTAR",[n,h,p]);var u=r,d=a+1;if(d===l){for(this.debug("** at the end");r<c;r++)if("."===t[r]||".."===t[r]||!s.dot&&"."===t[r].charAt(0))return!1;return!0}for(;u<c;){var g=t[u];if(this.debug("\nglobstar while",t,u,n,d,g),this.matchOne(t.slice(u),n.slice(d),i))return this.debug("globstar found match!",u,c,g),!0;if("."===g||".."===g||!s.dot&&"."===g.charAt(0)){this.debug("dot detected!",t,u,n,d);break}this.debug("globstar swallow a segment, and continue"),u++}return!(!i||(this.debug("\n>>> no match, partial?",t,u,n,d),u!==c))}let o;if("string"==typeof h?(o=p===h,this.debug("string match",h,p,o)):(o=h.test(p),this.debug("pattern match",h,p,o)),!o)return!1}if(r===c&&a===l)return!0;if(r===c)return i;if(a===l)return r===c-1&&""===t[r];throw new Error("wtf?")}braceExpand(){return(0,e.braceExpand)(this.pattern,this.options)}parse(t){(0,r.assertValidPattern)(t);const n=this.options;if("**"===t)return e.GLOBSTAR;if(""===t)return"";let i,s=null;(i=t.match(S))?s=n.dot?T:v:(i=t.match(h))?s=(n.nocase?n.dot?g:d:n.dot?u:p)(i[1]):(i=t.match(x))?s=(n.nocase?n.dot?k:M:n.dot?C:_)(i):(i=t.match(m))?s=n.dot?y:f:(i=t.match(w))&&(s=b);const o=a.AST.fromGlob(t,this.options).toMMPattern();return s?Object.assign(o,{test:s}):o}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const t=this.set;if(!t.length)return this.regexp=!1,this.regexp;const n=this.options,i=n.noglobstar?"[^/]*?":n.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",s=new Set(n.nocase?["i"]:[]);let o=t.map((t=>{const n=t.map((t=>{if(t instanceof RegExp)for(const e of t.flags.split(""))s.add(e);return"string"==typeof t?t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):t===e.GLOBSTAR?e.GLOBSTAR:t._src}));return n.forEach(((t,s)=>{const o=n[s+1],r=n[s-1];t===e.GLOBSTAR&&r!==e.GLOBSTAR&&(void 0===r?void 0!==o&&o!==e.GLOBSTAR?n[s+1]="(?:\\/|"+i+"\\/)?"+o:n[s]=i:void 0===o?n[s-1]=r+"(?:\\/|"+i+")?":o!==e.GLOBSTAR&&(n[s-1]=r+"(?:\\/|\\/"+i+"\\/)"+o,n[s+1]=e.GLOBSTAR))})),n.filter((t=>t!==e.GLOBSTAR)).join("/")})).join("|");const[r,a]=t.length>1?["(?:",")"]:["",""];o="^"+r+o+a+"$",this.negate&&(o="^(?!"+o+").+$");try{this.regexp=new RegExp(o,[...s].join(""))}catch(t){this.regexp=!1}return this.regexp}slashSplit(t){return this.preserveMultipleSlashes?t.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(t)?["",...t.split(/\/+/)]:t.split(/\/+/)}match(t,e=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;const n=this.options;this.isWindows&&(t=t.split("\\").join("/"));const i=this.slashSplit(t);this.debug(this.pattern,"split",i);const s=this.set;this.debug(this.pattern,"set",s);let o=i[i.length-1];if(!o)for(let t=i.length-2;!o&&t>=0;t--)o=i[t];for(let t=0;t<s.length;t++){const r=s[t];let a=i;if(n.matchBase&&1===r.length&&(a=[o]),this.matchOne(a,r,e))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate}static defaults(t){return e.minimatch.defaults(t).Minimatch}}e.Minimatch=I;var N=n(9767);Object.defineProperty(e,"AST",{enumerable:!0,get:function(){return N.AST}});var A=n(4820);Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return A.escape}});var F=n(4023);Object.defineProperty(e,"unescape",{enumerable:!0,get:function(){return F.unescape}}),e.minimatch.AST=a.AST,e.minimatch.Minimatch=I,e.minimatch.escape=c.escape,e.minimatch.unescape=l.unescape},4023:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unescape=void 0,e.unescape=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}var i={};(()=>{"use strict";var t=i;Object.defineProperty(t,"__esModule",{value:!0}),t.activate=void 0;const e=n(9496),s=n(2842),o=n(7661),r=n(4165),a=n(8593),c=n(120),l=n(2);let h,p;t.activate=function(t){if(e.commands.executeCommand("setContext","outline-map.workspace.enabled",!0),r.config.workspaceEnabled()){h=new c.WorkspaceSymbols(t.workspaceState,e.workspace.workspaceFolders?.map((t=>t.uri))||[]);const n=e.window.createTreeView("outline-map-workspace",{treeDataProvider:h,showCollapseAll:!0});t.subscriptions.push(e.workspace.onDidDeleteFiles((t=>{h?.removeDocuments(t.files)})),e.workspace.onDidRenameFiles((t=>{h?.renameDocuments(t.files)})),e.workspace.onDidChangeConfiguration((t=>{h?.updateConfig()})),n)}r.config.regionEnabled()&&(p=new l.RegionProvider,r.config.regionRegisterSymbolProvider()&&e.languages.registerDocumentSymbolProvider({scheme:"file"},p),e.languages.registerFoldingRangeProvider({scheme:"file"},p),e.workspace.onDidChangeConfiguration((()=>{p?.updateDecorationsConfig()})));const n=new s.OutlineView({context:t,workspaceSymbols:h,regionProvider:r.config.regionRegisterSymbolProvider()?void 0:p,initialSearch:t.globalState.get("searchField",!1)});t.subscriptions.push(e.window.registerWebviewViewProvider("outline-map-view",n),e.window.onDidChangeActiveTextEditor((t=>{const i=t?.document||e.window.activeTextEditor?.document;n.update(i)})),e.window.onDidChangeTextEditorSelection((0,a.debounce)((t=>{n.focus(t.selections),e.window.activeTextEditor?.visibleRanges&&n.updateViewPort(e.window.activeTextEditor.visibleRanges[0]),"cursor"===r.config.follow()&&n.postMessage({type:"scroll",data:{follow:"focus"}})}),300)),e.window.onDidChangeTextEditorVisibleRanges((0,a.throttle)((t=>{"viewport"===r.config.follow()&&(n.updateViewPort(t.visibleRanges[0]),n.postMessage({type:"scroll",data:{follow:"in-view"}}))}),100)),e.workspace.onDidChangeTextDocument((0,a.debounce)((t=>{const e=t.document;n.update(e)}),300)),e.languages.onDidChangeDiagnostics((0,a.debounce)((t=>{const i=e.window.activeTextEditor?.document.uri||t.uris[0],s=e.languages.getDiagnostics(i);n.updateDiagnostics(s)}),300)),...o.OutlineViewCommandList.map((i=>e.commands.registerCommand(i.name,i.fn.bind(null,n,t.globalState)))),...o.WorkspaceCommandList.map((t=>e.commands.registerCommand(t.name,t.fn.bind(null,h)))))}})();var s=exports;for(var o in i)s[o]=i[o];i.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();